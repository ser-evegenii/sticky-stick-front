"use strict";

var _interopRequireDefault = require("@babel/runtime-corejs2/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.splitUnserializableParts = splitUnserializableParts;

var _isArray = _interopRequireDefault(require("@babel/runtime-corejs2/core-js/array/is-array"));

var _keys = _interopRequireDefault(require("@babel/runtime-corejs2/core-js/object/keys"));

var _lodash = _interopRequireDefault(require("lodash.isplainobject"));

function splitUnserializableParts(obj) {
  var serializable = {};
  var unserializable = {};
  (0, _keys.default)(obj).forEach(function (key) {
    if (isSerializable(obj[key])) {
      serializable[key] = obj[key];
    } else if (key === 'props' && (0, _lodash.default)(obj[key])) {
      (0, _keys.default)(obj.props).forEach(function (propKey) {
        var propVal = obj.props[propKey];
        var propHome = isSerializable(propVal) ? serializable : unserializable;

        if (!propHome.props) {
          propHome.props = {};
        }

        propHome.props[propKey] = propVal;
      });
    } else {
      unserializable[key] = obj[key];
    }
  });
  return {
    serializable: serializable,
    unserializable: unserializable
  };
}

function isSerializable(obj) {
  if (obj === undefined || obj === null || typeof obj === 'boolean' || typeof obj === 'number' || typeof obj === 'string') {
    return true;
  }

  if (!(0, _lodash.default)(obj) && !(0, _isArray.default)(obj)) {
    return false;
  }

  var serializable = true;
  (0, _keys.default)(obj).forEach(function (key) {
    if (!isSerializable(obj[key])) {
      serializable = false;
    }
  });
  return serializable;
}